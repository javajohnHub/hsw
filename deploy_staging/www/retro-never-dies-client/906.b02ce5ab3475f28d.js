"use strict";(self.webpackChunkretro_never_dies_client=self.webpackChunkretro_never_dies_client||[]).push([[906],{4906:(A,C,f)=>{f.r(C),f.d(C,{GamesWheelComponent:()=>y});var b=f(2881),t=f(1360),G=f(7643),P=f(671);function M(i,p){if(1&i&&(t.j41(0,"div",19),t.EFF(1),t.k0s()),2&i){const n=p.$implicit;t.R7$(),t.SpI(" ",n.name," ")}}function w(i,p){1&i&&(t.j41(0,"div",20),t.EFF(1,"All games have been chosen!"),t.k0s())}function k(i,p){if(1&i&&(t.j41(0,"div",21),t.EFF(1),t.k0s()),2&i){const n=t.XpG();t.R7$(),t.JRh(n.gamesFeedback)}}function O(i,p){if(1&i){const n=t.RV6();t.j41(0,"div",22)(1,"span",23),t.EFF(2),t.k0s(),t.j41(3,"button",24),t.bIt("click",function(){const s=t.eBV(n).$implicit,a=t.XpG();return t.Njj(a.returnGameToWheel(s))}),t.EFF(4,"Return to Wheel"),t.k0s()()}if(2&i){const n=p.$implicit;t.R7$(2),t.JRh(n.name)}}function F(i,p){1&i&&(t.j41(0,"div",20),t.EFF(1,"No games chosen yet"),t.k0s())}let y=(()=>{class i{http;authService;games=[];availableGames=[];chosenGames=[];selectedGame=null;spinning=!1;angle=0;gamesFeedback="";faviconImg=null;constructor(n,e){this.http=n,this.authService=e}ngOnInit(){this.authService.isAdminMode||this.authService.redirectToPublic()}ngAfterViewInit(){this.loadFavicon(),this.loadGames()}loadFavicon(){this.faviconImg=new Image,this.faviconImg.onload=()=>{this.drawGamesWheel()},this.faviconImg.src="favicon.ico"}loadGames(){this.http.get("http://localhost:4000/games").subscribe({next:n=>{console.log("Games loaded:",n),Array.isArray(n)&&(this.games=n,this.updateGameLists(),this.drawGamesWheel())},error:n=>{console.error("Error loading games:",n),this.games=[{id:1,name:"Street Fighter 6",category:"Fighting"},{id:2,name:"Tekken 8",category:"Fighting"},{id:3,name:"Guilty Gear Strive",category:"Fighting"},{id:4,name:"Mortal Kombat 1",category:"Fighting"},{id:5,name:"Super Smash Bros Ultimate",category:"Platform Fighter"}],this.updateGameLists(),this.drawGamesWheel()}})}updateGameLists(){this.availableGames=this.games.filter(n=>!n.isChosen),this.chosenGames=this.games.filter(n=>n.isChosen)}truncateText(n,e,s,a=9){const l="...";if(e.length>a)return e.slice(0,a)+l;if(n.measureText(e).width<=s)return e;let r=e;for(;r.length>0;){const c=r+l;if(n.measureText(c).width<=s)return c;r=r.slice(0,-1)}return l}drawGamesWheel(){const n=document.querySelector("canvas.games-canvas");if(!n)return;const e=n.getContext("2d");if(!e)return;const s=n.width,a=s/2,l=a-10;e.clearRect(0,0,s,s);const r=this.availableGames,c=r.length;if(0===c)return e.beginPath(),e.arc(a,a,l,0,2*Math.PI),e.fillStyle="#666",e.fill(),e.strokeStyle="#fff",e.lineWidth=2,e.stroke(),e.textAlign="center",e.font="bold 1.5rem Orbitron, Arial",e.fillStyle="#fff",void e.fillText("No Games",a,a);const m=2*Math.PI/c;let d=this.selectedGame?r.findIndex(o=>o.name===this.selectedGame):-1;for(let o=0;o<c;o++){const g=this.angle+o*m,T=g+m;e.beginPath(),e.moveTo(a,a),e.arc(a,a,l,g,T),e.closePath(),o===d?(e.fillStyle="#53fc19",e.globalAlpha=.95,e.fill(),e.globalAlpha=1,e.strokeStyle="#fff",e.lineWidth=8,e.stroke()):(e.fillStyle=o%2==0?"#53fc19":"#181a1b",e.globalAlpha=.85,e.fill(),e.globalAlpha=1,e.strokeStyle="#fff",e.lineWidth=2,e.stroke()),e.save(),e.translate(a,a),e.rotate(g+m/2),e.textAlign="right",e.font="bold 0.8rem Orbitron, Arial",e.fillStyle=o===d?"#181a1b":"#fff",e.shadowColor=o===d?"#53fc19":"#181a1b",e.shadowBlur=o===d?8:4;const x=r[o].name,u=l-25;if(x.length>9){const h=x.split(" ");if(h.length>1){const _=h.slice(0,Math.ceil(h.length/2)).join(" "),I=h.slice(Math.ceil(h.length/2)).join(" "),W=this.truncateText(e,_,u),E=this.truncateText(e,I,u);e.fillText(W,l-18,-4),e.fillText(E,l-18,12)}else{const _=this.truncateText(e,x,u);e.fillText(_,l-18,4)}}else{const h=this.truncateText(e,x,u);e.fillText(h,l-18,4)}e.restore()}e.save(),e.translate(a,a),e.rotate(this.angle),e.beginPath(),e.arc(0,0,40,0,2*Math.PI),e.fillStyle="#fff",e.fill(),e.strokeStyle="#53fc19",e.lineWidth=3,e.stroke(),this.faviconImg&&this.faviconImg.complete&&e.drawImage(this.faviconImg,-25,-25,50,50),e.restore(),e.save(),e.translate(a,20),e.beginPath(),e.moveTo(0,0),e.lineTo(-15,-25),e.lineTo(-5,-15),e.lineTo(5,-15),e.lineTo(15,-25),e.lineTo(0,0),e.closePath(),e.fillStyle="#fff",e.strokeStyle="#181a1b",e.lineWidth=2,e.shadowColor="#53fc19",e.shadowBlur=8,e.fill(),e.stroke(),e.restore()}spinGamesWheel(){if(this.spinning||0===this.availableGames.length)return;this.spinning=!0,this.gamesFeedback="Spinning for a game...";const n=Math.floor(Math.random()*this.availableGames.length),e=2*Math.PI/this.availableGames.length,s=3*Math.PI/2-(e*n+e/2);let a=this.angle,l=performance.now(),c=6*Math.PI+s;const m=3e3,d=v=>{let o=v-l;if(o>m&&(o=m),this.angle=a+o/m*(c-a),this.drawGamesWheel(),o<m)requestAnimationFrame(d);else{this.angle=c%(2*Math.PI),this.drawGamesWheel();const g=this.availableGames[n];this.selectedGame=g.name,this.spinning=!1,g.isChosen=!0,this.updateGameLists(),this.http.put(`http://localhost:4000/games/${g.id}`,g).subscribe({next:()=>{this.gamesFeedback=`${g.name} has been chosen!`,this.drawGamesWheel(),setTimeout(()=>{this.gamesFeedback=""},3e3)},error:()=>{this.gamesFeedback="Error saving game selection."}})}};requestAnimationFrame(d)}returnGameToWheel(n){n.isChosen=!1,this.updateGameLists(),this.http.put(`http://localhost:4000/games/${n.id}`,n).subscribe({next:()=>{this.drawGamesWheel(),this.gamesFeedback=`${n.name} returned to wheel`,setTimeout(()=>{this.gamesFeedback=""},2e3)},error:()=>{this.gamesFeedback="Error returning game to wheel."}})}resetChosenGames(){confirm("Reset all chosen games back to the wheel?")&&(this.games.forEach(n=>n.isChosen=!1),this.updateGameLists(),this.http.post("http://localhost:4000/games/reset",{}).subscribe({next:()=>{this.drawGamesWheel(),this.gamesFeedback="All games reset to wheel",setTimeout(()=>{this.gamesFeedback=""},2e3)},error:()=>{this.gamesFeedback="Error resetting games."}}))}static \u0275fac=function(e){return new(e||i)(t.rXU(G.Qq),t.rXU(P.u))};static \u0275cmp=t.VBU({type:i,selectors:[["app-games-wheel"]],decls:28,vars:9,consts:[["gamesCanvas",""],[1,"games-bg"],[1,"games-title"],[1,"games-main-layout"],[1,"games-left-column"],[1,"games-image-wheel-row"],[1,"games-container"],["width","350","height","350",1,"games-canvas",3,"click"],[1,"games-panel-compact"],[1,"available-games-compact"],["class","available-game-compact",4,"ngFor","ngForOf"],["class","no-games",4,"ngIf"],[1,"games-right-column"],[1,"selected-game","animate-pop"],[1,"selected-name"],["class","games-feedback",4,"ngIf"],[1,"games-panel"],[1,"chosen-games-list"],["class","chosen-game-item",4,"ngFor","ngForOf"],[1,"available-game-compact"],[1,"no-games"],[1,"games-feedback"],[1,"chosen-game-item"],[1,"game-name"],[1,"return-btn",3,"click"]],template:function(e,s){if(1&e){const a=t.RV6();t.j41(0,"div",1)(1,"h1",2),t.EFF(2),t.k0s(),t.j41(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"canvas",7,0),t.bIt("click",function(){return t.eBV(a),t.Njj(s.spinGamesWheel())}),t.k0s()()(),t.j41(9,"div",8)(10,"h2"),t.EFF(11),t.k0s(),t.j41(12,"div",9),t.DNE(13,M,2,1,"div",10)(14,w,2,0,"div",11),t.k0s()()(),t.j41(15,"div",12)(16,"div",13)(17,"h2"),t.EFF(18,"Selected Game:"),t.k0s(),t.j41(19,"div",14),t.EFF(20),t.k0s(),t.DNE(21,k,2,1,"div",15),t.k0s(),t.j41(22,"div",16)(23,"h2"),t.EFF(24,"Chosen Games"),t.k0s(),t.j41(25,"div",17),t.DNE(26,O,5,1,"div",18)(27,F,2,0,"div",11),t.k0s()()()()()}2&e&&(t.R7$(2),t.Lme("Available Games: ",s.availableGames.length," | Chosen Games: ",s.chosenGames.length,""),t.R7$(9),t.SpI("Available Games (",s.availableGames.length,")"),t.R7$(2),t.Y8G("ngForOf",s.availableGames),t.R7$(),t.Y8G("ngIf",0===s.availableGames.length),t.R7$(6),t.JRh(s.selectedGame||"No selection yet"),t.R7$(),t.Y8G("ngIf",s.gamesFeedback),t.R7$(5),t.Y8G("ngForOf",s.chosenGames),t.R7$(),t.Y8G("ngIf",0===s.chosenGames.length))},dependencies:[b.MD,b.Sq,b.bT],styles:[".games-bg[_ngcontent-%COMP%]{min-height:100vh;background:#181a1b;font-family:Orbitron,Arial Black,Arial,sans-serif;color:#fff;padding:20px}.games-title[_ngcontent-%COMP%]{text-align:center;font-size:2.5rem;font-weight:900;color:#ddd;text-shadow:2px 2px 0 #181a1b,0 0 12px #53fc19;margin:0 0 16px}.games-main-layout[_ngcontent-%COMP%]{display:flex;gap:20px;max-width:1400px;margin:0 auto;align-items:flex-start}.games-left-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;flex:1;max-width:600px}.games-right-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;max-width:600px}.games-image-wheel-row[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:center;margin-bottom:16px}.games-banner[_ngcontent-%COMP%]{margin-bottom:0}.games-img[_ngcontent-%COMP%]{max-width:400px;height:auto}.games-container[_ngcontent-%COMP%]{width:350px;height:350px;margin-bottom:16px;display:flex;justify-content:center;align-items:center}.games-canvas[_ngcontent-%COMP%]{border-radius:50%;box-shadow:0 0 24px #53fc19,0 0 32px #181a1b inset;background:#fff}.games-btn-row[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:16px;margin:16px 0;flex-wrap:wrap}.games-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#53fc19,#48e017);color:#181a1b;border:none;padding:12px 24px;border-radius:8px;font-weight:900;font-size:1rem;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 12px #53fc194d}.games-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 16px #53fc1980}.games-btn[_ngcontent-%COMP%]:disabled{background:#333;color:#666;cursor:not-allowed;transform:none;box-shadow:none}.selected-game[_ngcontent-%COMP%]{background:#53fc1926;border:2px solid #53fc19;border-radius:12px;padding:20px 24px;margin:16px 0;text-align:center}.selected-game[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#ddd;font-size:1.4rem}.selected-game[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;color:#ddd}.games-lists[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:24px}.games-section[_ngcontent-%COMP%]{background:#ffffff0d;border-radius:12px;padding:20px;border:1px solid rgba(83,252,25,.3)}.games-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;color:#ddd;font-size:1.3rem;text-align:center}.games-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;max-height:400px;overflow-y:auto}.games-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:8px 12px;margin-bottom:4px;background:#ffffff1a;border-radius:6px;font-size:.95rem;border-left:3px solid #53fc19}.games-img-col[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.games-wheel-col[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;left:-200px;top:150px}.games-panel[_ngcontent-%COMP%]{background:#181a1bf2;border-radius:18px;box-shadow:0 0 24px #53fc19,0 0 32px #181a1b inset;padding:20px 24px;margin:16px 0;color:#fff}.games-panel-compact[_ngcontent-%COMP%]{background:#181a1bf2;border-radius:18px;box-shadow:0 0 24px #53fc19,0 0 32px #181a1b inset;padding:16px 20px;margin:16px 0;color:#fff}.chosen-games-list[_ngcontent-%COMP%], .available-games-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:12px;margin-top:16px}.chosen-game-item[_ngcontent-%COMP%], .available-game-item[_ngcontent-%COMP%]{background:#53fc191a;border:1px solid #53fc19;border-radius:8px;padding:12px;display:flex;justify-content:space-between;align-items:center}.game-name[_ngcontent-%COMP%]{color:#ddd;font-weight:700;flex:1}.return-btn[_ngcontent-%COMP%]{background:#53fc19;color:#181a1b;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:.9rem}.return-btn[_ngcontent-%COMP%]:hover{background:#45d915}.no-games[_ngcontent-%COMP%]{color:#666;font-style:italic;text-align:center;padding:20px;grid-column:1 / -1}.available-games-full-row[_ngcontent-%COMP%]{max-width:1400px;margin:24px auto 0}.games-panel-full[_ngcontent-%COMP%]{background:#181a1bf2;border-radius:18px;box-shadow:0 0 24px #53fc19,0 0 32px #181a1b inset;padding:24px 32px;color:#fff}.available-games-compact[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-top:16px}.available-game-compact[_ngcontent-%COMP%]{background:#53fc191a;border:1px solid #53fc19;border-radius:4px;padding:6px 8px;color:#ddd;font-weight:700;font-size:.8rem;text-align:center}@media (max-width: 900px){.games-flex[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.games-panel[_ngcontent-%COMP%]{max-width:98vw}.games-container[_ngcontent-%COMP%]{width:98vw;height:98vw;max-width:400px;max-height:400px}}"]})}return i})()}}]);